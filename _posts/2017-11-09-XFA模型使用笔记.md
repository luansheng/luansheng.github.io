---
layout: post
title: FA和XFA学习笔记
categories: 统计 方差结构
description: 弄清楚FA和XFA的定义，以及因子分析模型。
keywords: R, FA, XFA, ASReml
---

ASReml中有一个XFA方差结构。本文从因子分析基础入手，做一个学习笔记。



## 1.1 因子分析的基本概念
因子分析(factor analysis)是一种数据简化的技术。它通过研究众**多变量**之间的内部依赖关系（这里指的变量是譬如**体长、体重、头胸甲等性状**，而不是样品编号），探求观测数据中的**基本结构**，并用少数几个**基础变量**（underlying variate）来表示其基本的数据结构。这几个基础变量能够反映原来众多变量的主要信息。原始的变量是可观测的变量，而基础变量是不可观测的潜在变量，称为**因子**。

因子分析实际上是降维的一种方法。

譬如：在企业形象或品牌形象的研究中，消费者可以通过一个有24个指标构成的评价体系，评价百货商场的24个方面的优劣。但消费者主要关心的是三个方面，即商店的环境、商店的服务和商品的价格。因子分析方法可以通过24个变量，找出反映商店环境、商店服务水平和商品价格的4个公共潜在的因子，对商店进行综合评价。而这4个公共因子可以表示为：
$$
x_{i}=\mu_{i}+\alpha_{i1}F_{1}+\alpha_{i2}F_{2}+\alpha_{i3}F_{3}+\alpha_{i4}F_{4}+\varepsilon_{i}
$$

下边对上述模型的解释尤为重要,提到了两个非常重要的概念，**公共因子**和**特殊因子**：

其中，$$x_{i}$$表示每个指标（变量），F1，F2，F3和F4表示不可观测的4个公共因子，24个指标（变量）共享这4个因子，每个指标（变量）中不能被共享的部分，称为特殊因子$$\varepsilon_{i}$$。

因子分析与主成分分析的异同（最好有实际的例子展示）

* 主成分分析: 初始变量的线性组合表示新的综合变量，即主成分；
* 因子分析：潜在的基础变量即公共变量和特殊变量的线性组合表示原始变量；
* 主成分分析仅仅是变量转换，而因子分析需要构造因子分析模型。

## 1.2 因子分析的数学模型

首先来看一个数学模型：

模型的方式表示为：

$$
X = \mu + AF + \varepsilon
$$

其中X为观测变量矩阵, A为载荷因子矩阵，F为公共因子矩阵，$$\varepsilon$$为特殊因子矩阵。

矩阵形式表示为：

$$
\begin{bmatrix}
x_{1} \\ 
x_{2} \\ 
...   \\
x_{p} \\ 
\end{bmatrix} 
= 
\begin{bmatrix}
\mu_{1} \\ 
\mu_{2} \\ 
...     \\
\mu_{p} \\ 
\end{bmatrix}
+
\begin{bmatrix}
\alpha_{11} & \alpha_{12} & ... & \alpha_{1m} \\ 
\alpha_{21} & \alpha_{22} & ... & \alpha_{2m} \\ 
\vdots      & \vdots      & \vdots & \vdots   \\ 
\alpha_{p1} & \alpha_{p2} & ... & \alpha_{pm} \\ 
\end{bmatrix}
\begin{bmatrix}
F_{1} \\ 
F_{2} \\ 
...   \\
F_{m} \\ 
\end{bmatrix}
+
\begin{bmatrix}
\varepsilon_{1} \\ 
\varepsilon_{2} \\ 
...     \\
\varepsilon_{p} \\ 
\end{bmatrix}
$$

上边这个模型中，$$x_{p}$$表示第p个可观察的变量，对应到例子中24个指标(p=24)；m表示公共因子的数量，对应到上边的例子，m=4；$$a_{pm}$$称为因子载荷矩阵，p行m列，对应到例子为24行4列；$$\varepsilon_{p}$$表示特殊因子，对应到例子中24个指标(p=24)。

## 1.3 因子分析模型的一些性质

* 公共因子和特殊因子之间独立，协方差为0，不相关。

$$ cov(F,\varepsilon) = 0 $$
* 公共因子间不相关，每个因子的方差为1。

$$
D(F) = 
\begin{bmatrix}
1 &   &   &   \\ 
  & 1 &   &   \\ 
  &   & \ddots &   \\ 
  &   &   & 1 \\ 
\end{bmatrix}
$$

* 特殊因子间不相关，每个因子的方差可以不等。

$$
D(\varepsilon) = 
\begin{bmatrix}
\sigma^2_{1} &   &   &   \\ 
  & \sigma^2_{2} &   &   \\ 
  &   & \ddots &   \\ 
  &   &   & \sigma^2_{p} \\ 
\end{bmatrix}
$$

  